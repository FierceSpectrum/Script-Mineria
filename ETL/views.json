{
    "views": [
        {
            "name": "VDIM_EMPLOYEES",
            "query": "SELECT CAST(EM.CODIGO_EMPLEADO AS NVARCHAR(10)) AS EMPLOYEE_ID, EM.NOMBRE + ' ' + EM.APELLIDO1 AS FULL_NAME, EM.PUESTO AS TITLE, O.CIUDAD AS CITY, O.PAIS AS COUNTRY, ISNULL(J.NOMBRE + ' ' + J.APELLIDO1, 'COMITE GERENCIAL') AS REPORTS_TO, cast('JARDINERIA'as NVARCHAR(10)) AS DB_ORIGIN FROM EMPLEADO EM LEFT JOIN OFICINA O ON EM.CODIGO_OFICINA = O.CODIGO_OFICINA LEFT JOIN EMPLEADO J ON EM.CODIGO_JEFE = J.CODIGO_EMPLEADO UNION SELECT E.EMPLOYEEID AS EMPLOYEE_ID, E.FIRSTNAME + ' ' + E.LASTNAME AS FULL_NAME, E.TITLE AS TITLE, E.CITY AS CITY, E.COUNTRY AS COUNTRY, ISNULL(B.FIRSTNAME + ' ' + B.LASTNAME, 'COMITE GERENCIAL') AS REPORTS_TO, 'NORTHWIND' AS DB_ORIGIN FROM EMPLOYEES E LEFT JOIN EMPLOYEES B ON E.REPORTSTO = B.EMPLOYEEID",
            "translate": [],
            "country": [
                "country"
            ],
            "upper": [
                "full_name",
                "title",
                "city",
                "region",
                "country",
                "reports_to",
                "db_origin"
            ]
        },
        {
            "name": "VDIM_DATES",
            "query": "SELECT DISTINCT CASE SUBSTRING( CONVERT(VARCHAR(10), O.OrderDate, 23), 1, 4 ) WHEN '1996' THEN CONCAT( '2020-', SUBSTRING( CONVERT(VARCHAR(10), O.OrderDate, 23), 6, 5 ) ) WHEN '1997' THEN CONCAT( '2021-', SUBSTRING( CONVERT(VARCHAR(10), O.OrderDate, 23), 6, 5 ) ) WHEN '1998' THEN CONCAT( '2022-', SUBSTRING( CONVERT(VARCHAR(10), O.OrderDate, 23), 6, 5 ) ) ELSE SUBSTRING( CONVERT(VARCHAR(10), O.OrderDate, 23), 1, 4 ) END AS DATE, CASE YEAR(O.OrderDate) WHEN '1996' THEN '2020' WHEN '1997' THEN '2021' WHEN '1998' THEN '2022' ELSE YEAR(O.OrderDate) END AS YEAR, MONTH(O.OrderDate) AS MOUNTH, DAY(O.OrderDate) AS DAY, CASE WHEN MONTH(O.OrderDate) IN (1, 2, 3) THEN 1 WHEN MONTH(O.OrderDate) IN (4, 5, 6) THEN 2 WHEN MONTH(O.OrderDate) IN (7, 8, 9) THEN 3 ELSE 4 END AS FOUR_MONTH, CASE WHEN MONTH(O.OrderDate) IN (1, 2, 3, 4) THEN 1 WHEN MONTH(O.OrderDate) IN (5, 6, 7, 8) THEN 2 ELSE 3 END AS QUARTER, DATEPART(WEEK, O.OrderDate) AS WEEK, CASE DATEPART(WEEKDAY, O.OrderDate) WHEN 1 THEN 'Domingo' WHEN 2 THEN 'Lunes' WHEN 3 THEN 'Martes' WHEN 4 THEN 'Miercoles' WHEN 5 THEN 'Jueves' WHEN 6 THEN 'Viernes' WHEN 7 THEN 'Sabado' END AS WEEK_DAY, DATEPART(DAYOFYEAR, O.OrderDate) AS YEAR_DAY, CAST('NORTHWIND' AS NVARCHAR(10)) AS DB_ORIGIN FROM dbo.Orders AS O UNION SELECT DISTINCT CONVERT( VARCHAR(10), J.FECHA_PEDIDO, 23 ) AS DATE, YEAR(J.FECHA_PEDIDO) AS YEAR, MONTH(J.FECHA_PEDIDO) AS MOUNTH, DAY(J.FECHA_PEDIDO) AS DAY, CASE WHEN MONTH(J.FECHA_PEDIDO) IN (1, 2, 3) THEN 1 WHEN MONTH(J.FECHA_PEDIDO) IN (4, 5, 6) THEN 2 WHEN MONTH(J.FECHA_PEDIDO) IN (7, 8, 9) THEN 3 ELSE 4 END AS FOUR_MONTH, CASE WHEN MONTH(J.FECHA_PEDIDO) IN (1, 2, 3, 4) THEN 1 WHEN MONTH(J.FECHA_PEDIDO) IN (5, 6, 7, 8) THEN 2 ELSE 3 END AS QUARTER, DATEPART(WEEK, J.FECHA_PEDIDO) AS WEEK, CASE DATEPART(WEEKDAY, J.FECHA_PEDIDO) WHEN 1 THEN 'Domingo' WHEN 2 THEN 'Lunes' WHEN 3 THEN 'Martes' WHEN 4 THEN 'Miercoles' WHEN 5 THEN 'Jueves' WHEN 6 THEN 'Viernes' WHEN 7 THEN 'Sabado' END AS WEEK_DAY, DATEPART(DAYOFYEAR, J.FECHA_PEDIDO) AS YEAR_DAY, 'JARDINERIA' AS DB_ORIGIN FROM dbo.Pedido AS J",
            "translate": [],
            "country": [],
            "upper": [
                "week_day",
                "db_origin"
            ]
        }
    ]
}